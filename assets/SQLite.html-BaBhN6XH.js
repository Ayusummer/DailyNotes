import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as p,c as i,a as s,d as n,b as e,e as t}from"./app-DxMJFouC.js";const c={},r=t('<h1 id="sqlite" tabindex="-1"><a class="header-anchor" href="#sqlite"><span>SQLite</span></a></h1><ul><li><a href="#sqlite">SQLite</a><ul><li><a href="#virtual-columns">virtual columns</a></li><li><a href="#%E8%87%AA%E5%A2%9E%E9%87%8F%E5%BD%92%E9%9B%B6">è‡ªå¢é‡å½’é›¶</a></li><li><a href="#litestream">Litestream</a></li></ul></li></ul><h2 id="virtual-columns" tabindex="-1"><a class="header-anchor" href="#virtual-columns"><span>virtual columns</span></a></h2>',3),u={href:"https://antonz.org/json-virtual-columns/",target:"_blank",rel:"noopener noreferrer"},d=t(`<p>å¦‚ä½•åœ¨ SQLite ä¸­ä½¿ç”¨ JSON å’Œ Virtual Columns å®ç°ä¸€äº›æ›´çµæ´»çš„ç”¨æ³•</p><p>å‡è®¾æˆ‘ä»¬æƒ³è¦ä¿ç•™ç³»ç»Ÿä¸­ä¸€äº›äº‹ä»¶çš„æ—¥å¿—, æ¯ä¸ªäº‹ä»¶éƒ½æœ‰è‡ªå·±çš„ä¸€ç»„å­—æ®µ, ä¾‹å¦‚:</p><p><code>ç™»å½•</code>:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-05-15T09:31:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;object_id&quot;</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token property">&quot;action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;details&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.0.1&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>è´¦æˆ·å­˜æ¬¾</code>:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-05-15T09:32:00Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;object&quot;</span><span class="token operator">:</span> <span class="token string">&quot;account&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;object_id&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token property">&quot;action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deposit&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;details&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amount&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;currency&quot;</span><span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºè¿™ç§ json æ•°æ®çš„è§„èŒƒåŒ–å¹¶ä¸å®¹æ˜“, å› æ­¤å¯ä»¥ç›´æ¥å­˜å‚¨ json</p><p>åˆ›å»ºä¸€ä¸ª events è¡¨, åªåŒ…å«ä¸€ä¸ª text ç±»å‹çš„ value å­—æ®µ</p><p>value å­—æ®µçš„å€¼ä¸º:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span><span class="token string">&quot;2022-05-15T09:31:00Z&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object&quot;</span><span class="token operator">:</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object_id&quot;</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token property">&quot;action&quot;</span><span class="token operator">:</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;details&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;ip&quot;</span><span class="token operator">:</span><span class="token string">&quot;192.168.0.1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span><span class="token string">&quot;2022-05-15T09:32:00Z&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object&quot;</span><span class="token operator">:</span><span class="token string">&quot;account&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object_id&quot;</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token property">&quot;action&quot;</span><span class="token operator">:</span><span class="token string">&quot;deposit&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;details&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;amount&quot;</span><span class="token operator">:</span><span class="token string">&quot;1000&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;currency&quot;</span><span class="token operator">:</span><span class="token string">&quot;USD&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span><span class="token string">&quot;2022-05-15T09:33:00Z&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object&quot;</span><span class="token operator">:</span><span class="token string">&quot;company&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;object_id&quot;</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token property">&quot;action&quot;</span><span class="token operator">:</span><span class="token string">&quot;edit&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;details&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶å¯ä»¥é€šè¿‡ json è§£æ„æŸ¥è¡¨:</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>select
  json_extract(value, &#39;$.object&#39;) as object,
  json_extract(value, &#39;$.action&#39;) as action
from events
where json_extract(value, &#39;$.object_id&#39;) = 11;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/img/202205230849736.png" alt=""></p><p>åªæ˜¯æ»¡è¶³åŸºæœ¬æŸ¥è¯¢çš„è¯åˆ°æ­¤ä¸ºæ­¢å°±è¶³å¤Ÿäº†, ä½†æ˜¯å½“æ•°æ®é‡èµ·æ¥å, æŸ¥è¯¢é€Ÿåº¦ä¼šå˜å¾—å¾ˆæ…¢, æ­¤æ—¶å¯ä»¥é€šè¿‡å®šä¹‰è™šæ‹Ÿåˆ—å¹¶æ„å»ºç´¢å¼•æ¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦:</p><p><code>å®šä¹‰è™šæ‹Ÿåˆ—</code>:</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>alter table events
add column object_id integer
as (json_extract(value, &#39;$.object_id&#39;));

alter table events
add column object text
as (json_extract(value, &#39;$.object&#39;));

alter table events
add column action text
as (json_extract(value, &#39;$.action&#39;));
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>æ„å»ºç´¢å¼•</code>:</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>create index events_object_id on events(object_id);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/img/202205230909523.png" alt="image-20220523090909436"></p><p>ç„¶åä½¿ç”¨æ–°çš„è™šæ‹Ÿåˆ—å±æ€§è¿›è¡ŒæŸ¥è¯¢:</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>select object, action
from events
where object_id = 11;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è™šæ‹Ÿåˆ—çš„ä½¿ç”¨è®©æˆ‘ä»¬å‡ ä¹æ‹¥æœ‰äº†ä¸€ä¸ª NoSQL æ•°æ®åº“ğŸ˜‰</p><hr><h2 id="è‡ªå¢é‡å½’é›¶" tabindex="-1"><a class="header-anchor" href="#è‡ªå¢é‡å½’é›¶"><span>è‡ªå¢é‡å½’é›¶</span></a></h2>`,24),m={href:"https://www.bbsmax.com/A/n2d9l3gB5D/",target:"_blank",rel:"noopener noreferrer"},v=t(`<div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>DELETE FROM sqlite_sequence WHERE name = â€˜TableNameâ€™; --å¯ä»¥å°†é€’å¢æ•°å½’é›¶
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“ SQLite æ•°æ®åº“ä¸­åŒ…å«è‡ªå¢åˆ—æ—¶ï¼Œä¼šè‡ªåŠ¨å»ºç«‹ä¸€ä¸ªåä¸º <code>sqlite_sequence</code> çš„è¡¨ã€‚</p><p><code>sqlite_sequence</code> è¡¨åŒ…å«ä¸¤ä¸ªåˆ—ï¼šname å’Œ seqã€‚</p><ul><li><p><code>name</code> è®°å½•è‡ªå¢åˆ—æ‰€åœ¨çš„è¡¨</p></li><li><p><code>seq</code> è®°å½•å½“å‰åºå·(ä¸‹ä¸€æ¡è®°å½•çš„ç¼–å·å°±æ˜¯å½“å‰åºå·åŠ 1) ã€‚</p><p>å¦‚æœæƒ³æŠŠæŸä¸ªè‡ªå¢åˆ—çš„åºå·å½’é›¶ï¼Œåªéœ€è¦ä¿®æ”¹ <code>sqlite_sequence</code> è¡¨å°±å¯ä»¥äº†ã€‚</p></li></ul><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>UPDATE sqlite_sequence SET seq = 0 WHERE name = â€˜TableNameâ€™;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥ç›´æ¥æŠŠè¯¥è®°å½•åˆ æ‰ï¼š</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>DELETE FROM sqlite_sequence WHERE name = â€˜TableNameâ€™;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¦æƒ³å°†æ‰€æœ‰è¡¨çš„è‡ªå¢åˆ—éƒ½å½’é›¶ï¼Œç›´æ¥æ¸…ç©ºsqlite_sequenceè¡¨å°±å¯ä»¥äº†ï¼š</p><div class="language-sqlite line-numbers-mode" data-ext="sqlite" data-title="sqlite"><pre class="language-sqlite"><code>DELETE FROM sqlite_sequence;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><hr><h2 id="litestream" tabindex="-1"><a class="header-anchor" href="#litestream"><span>Litestream</span></a></h2>`,11),q={href:"https://github.com/benbjohnson/litestream",target:"_blank",rel:"noopener noreferrer"},k={href:"https://litestream.io/getting-started/",target:"_blank",rel:"noopener noreferrer"},b={href:"https://litestream.io/install/",target:"_blank",rel:"noopener noreferrer"},g=s("p",null,[s("code",null,"Litestream"),n(" æ˜¯ SQLite çš„ç‹¬ç«‹æµå¤åˆ¶å·¥å…·; å…¶ä½œä¸ºåå°è¿›è¡Œè¿è¡Œ, å¹¶å®‰å…¨åœ°å°†æ›´æ”¹å¢é‡å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶æˆ– S3;")],-1),h=s("p",null,[s("code",null,"Litestream"),n(" ä»…é€šè¿‡ "),s("code",null,"SQLite API"),n(" ä¸ "),s("code",null,"SQLite"),n(" é€šä¿¡, å› æ­¤å®ƒå¹¶ä¸ä¼šæŸåæ•°æ®åº“;")],-1),_=s("blockquote",null,[s("p",null,"Windows ä¸‹ä½¿ç”¨éœ€è¦ä»æºç è¿›è¡Œæ„å»º")],-1);function j(y,E){const a=l("ExternalLinkIcon");return p(),i("div",null,[r,s("blockquote",null,[s("p",null,[s("a",u,[n("JSON and virtual columns in SQLite (antonz.org)"),e(a)])])]),d,s("blockquote",null,[s("p",null,[s("a",m,[n("SQLite å¦‚ä½•æ¸…ç©ºè¡¨æ•°æ®å¹¶å°†é€’å¢é‡å½’é›¶ (bbsmax.com)"),e(a)])])]),v,s("blockquote",null,[s("p",null,[s("a",q,[n("benbjohnson/litestreamï¼šSQLite çš„ Streaming Replicationã€‚ (github.com)"),e(a)])]),s("p",null,[s("a",k,[n("Getting Started - Litestream"),e(a)])]),s("p",null,[s("a",b,[n("Install - Litestream"),e(a)])])]),g,h,_])}const L=o(c,[["render",j],["__file","SQLite.html.vue"]]),S=JSON.parse('{"path":"/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLite.html","title":"SQLite","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"virtual columns","slug":"virtual-columns","link":"#virtual-columns","children":[]},{"level":2,"title":"è‡ªå¢é‡å½’é›¶","slug":"è‡ªå¢é‡å½’é›¶","link":"#è‡ªå¢é‡å½’é›¶","children":[]},{"level":2,"title":"Litestream","slug":"litestream","link":"#litestream","children":[]}],"git":{"createdTime":1667962035000,"updatedTime":1709635981000,"contributors":[{"name":"233Official","email":"ayusummer233@qq.com","commits":2},{"name":"Ayusummer","email":"ayusummer233@gmail.com","commits":1}]},"readingTime":{"minutes":2.29,"words":688},"filePathRelative":"åç«¯/æ•°æ®åº“/SQLite.md","localizedDate":"2022å¹´11æœˆ9æ—¥","excerpt":"\\n<ul>\\n<li><a href=\\"#sqlite\\">SQLite</a>\\n<ul>\\n<li><a href=\\"#virtual-columns\\">virtual columns</a></li>\\n<li><a href=\\"#%E8%87%AA%E5%A2%9E%E9%87%8F%E5%BD%92%E9%9B%B6\\">è‡ªå¢é‡å½’é›¶</a></li>\\n<li><a href=\\"#litestream\\">Litestream</a></li>\\n</ul>\\n</li>\\n</ul>\\n<h2>virtual columns</h2>\\n<blockquote>\\n<p><a href=\\"https://antonz.org/json-virtual-columns/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">JSON and virtual columns in SQLite (antonz.org)</a></p>\\n</blockquote>"}');export{L as comp,S as data};
