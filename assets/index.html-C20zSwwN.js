import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as r,c as o,a as n,d as s,b as a,e as t}from"./app-DxMJFouC.js";const i={},c=t('<h1 id="加密算法" tabindex="-1"><a class="header-anchor" href="#加密算法"><span>加密算法</span></a></h1><ul><li><a href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95">加密算法</a><ul><li><a href="#%E4%BD%BF%E7%94%A8-openssl-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6">使用 openssl 生成自签名证书</a></li></ul></li></ul><hr><h2 id="使用-openssl-生成自签名证书" tabindex="-1"><a class="header-anchor" href="#使用-openssl-生成自签名证书"><span>使用 openssl 生成自签名证书</span></a></h2>',4),u={href:"https://slproweb.com/products/Win32OpenSSL.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://www.youtube.com/watch?v=1fln7glmX1E&list=PLfQqWeOCIH4AZt3TiSRP4UuL_Y3gxYPAW&index=23",target:"_blank",rel:"noopener noreferrer"},d=n("p",null,[n("img",{src:"http://cdn.ayusummer233.top/DailyNotes/202310232148230.png",alt:"image-20231023214800147"})],-1),v=n("hr",null,null,-1),k=n("p",null,"生成自签名 CA 根证书",-1),h={href:"https://www.youtube.com/watch?v=2sG8lLxOiLU&list=PLfQqWeOCIH4AZt3TiSRP4UuL_Y3gxYPAW&index=24",target:"_blank",rel:"noopener noreferrer"},b=t(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 生成 rsa 私钥</span>
openssl genrsa <span class="token parameter variable">-des3</span> <span class="token parameter variable">-out</span> ca.key <span class="token number">2048</span>
<span class="token comment"># 用私钥生成公钥证书(PS:时间不要超过13 个月[397 天])</span>
openssl req <span class="token parameter variable">-x509</span> <span class="token parameter variable">-key</span> ca.key <span class="token parameter variable">-out</span> ca.crt <span class="token parameter variable">-days</span> <span class="token number">365</span>
<span class="token comment"># 可以读一下证书的内容看看</span>
openssl x509 <span class="token parameter variable">-in</span> ca.crt <span class="token parameter variable">-text</span> <span class="token parameter variable">-noout</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240045190.png" alt="image-20231024004501134"></p>`,2),g={href:"https://stackoverflow.com/questions/64597721/neterr-cert-validity-too-long-the-server-certificate-has-a-validity-period-t",target:"_blank",rel:"noopener noreferrer"},y=t(`<p>生成私钥与证书与签名请求并通过刚才生成的 CA 根证书签名</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 生成 rsa 私钥</span>
openssl genrsa <span class="token parameter variable">-out</span> summer-py-server.key <span class="token number">2048</span>
<span class="token comment"># 用私钥生成证书签名请求</span>
openssl req <span class="token parameter variable">-new</span> <span class="token parameter variable">-key</span> summer-py-server.key <span class="token parameter variable">-out</span> summer-py-server.csr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>目前的浏览器校验证书都需要一个额外的校验证书备用名称的字段需要额外配置, 新建一个 <code>.ext</code> 文件</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">basicConstraints</span> <span class="token punctuation">=</span> <span class="token value attr-value">CA:FALSE</span>
<span class="token key attr-name">keyUsage</span> <span class="token punctuation">=</span> <span class="token value attr-value">nonRepudiation, digitalSignature, keyEncipherment</span>
<span class="token key attr-name">extendedKeyUsage</span> <span class="token punctuation">=</span> <span class="token value attr-value">serverAuth, clientAuth</span>
<span class="token key attr-name">subjectAltName</span> <span class="token punctuation">=</span> <span class="token value attr-value">@alt_names</span>

[alt_names]
<span class="token key attr-name">DNS.1</span> <span class="token punctuation">=</span> <span class="token value attr-value">ayusummer.com</span>
<span class="token key attr-name">DNS.2</span> <span class="token punctuation">=</span> <span class="token value attr-value">summer.com</span>
<span class="token key attr-name">IP.1</span> <span class="token punctuation">=</span> <span class="token value attr-value">172.29.64.1</span>
<span class="token key attr-name">IP.3</span> <span class="token punctuation">=</span> <span class="token value attr-value">127.0.0.1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),_={href:"https://vircloud.net/operations/sign-ip-crt.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://www.cnblogs.com/springwind2006/p/14273387.html",target:"_blank",rel:"noopener noreferrer"},f={href:"https://juejin.cn/post/7130417753483116557",target:"_blank",rel:"noopener noreferrer"},A=t(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 用 CA 根证书签名</span>
openssl x509 <span class="token parameter variable">-req</span> <span class="token parameter variable">-in</span> summer-py-server.csr <span class="token parameter variable">-CA</span> <span class="token punctuation">..</span>/ca/ca.crt <span class="token parameter variable">-CAkey</span> <span class="token punctuation">..</span>/ca/ca.key <span class="token parameter variable">-extfile</span> ext.ext <span class="token parameter variable">-set_serial</span> 01 <span class="token parameter variable">-out</span> summer-py-server.crt <span class="token parameter variable">-days</span> <span class="token number">365</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240051408.png" alt="image-20231024005104363"></p>`,2),S=t(`<li><p>python 起个 https server 试试</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> http<span class="token punctuation">.</span>server
<span class="token keyword">import</span> ssl

server_address <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span> <span class="token number">443</span><span class="token punctuation">)</span>
httpd <span class="token operator">=</span> http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>HTTPServer<span class="token punctuation">(</span>server_address<span class="token punctuation">,</span> http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>SimpleHTTPRequestHandler<span class="token punctuation">)</span>
httpd<span class="token punctuation">.</span>socket <span class="token operator">=</span> ssl<span class="token punctuation">.</span>wrap_socket<span class="token punctuation">(</span>
    httpd<span class="token punctuation">.</span>socket<span class="token punctuation">,</span>
    server_side<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    certfile<span class="token operator">=</span><span class="token string">&quot;key/py_server/summer-py-server.crt&quot;</span><span class="token punctuation">,</span>
    keyfile<span class="token operator">=</span><span class="token string">&quot;key/py_server/summer-py-server.key&quot;</span><span class="token punctuation">,</span>
    ssl_version<span class="token operator">=</span>ssl<span class="token punctuation">.</span>PROTOCOL_TLS<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
httpd<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232219356.png" alt="image-20231023221951330"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232220365.png" alt="image-20231023222030322"></p><p>安装根证书:</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232221334.png" alt="image-20231023222117285"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232221021.png" alt="image-20231023222132004"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232221264.png" alt="image-20231023222141250"></p><p>然后在双击这个证书可以看到已经能识别了</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232222957.png" alt="image-20231023222209941"></p><p>也可以从命令行使用 <code>certlm.msc</code> 调起证书管理器进行查看</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310232225280.png" alt="image-20231023222500265"></p><p>只需要加这个根证书就行了, 后续通过根证书申请的证书就无需添加了</p><p>此时再访问站点就没有不安全提示了</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240053403.png" alt="image-20231024005304390"></p><p>相应的 PowerShell 中 <code>Invoke-WebRequest</code> 也可以正常使用了</p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240100033.png" alt="image-20231024010004006"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240100419.png" alt="image-20231024010021409"></p><p><img src="http://cdn.ayusummer233.top/DailyNotes/202310240102000.png" alt="image-20231024010238987"></p></li>`,1);function x(w,L){const e=l("ExternalLinkIcon");return r(),o("div",null,[c,n("blockquote",null,[n("p",null,[n("a",u,[s("Win32/Win64 OpenSSL Installer for Windows - Shining Light Productions --- 适用于 Windows 的 Win32/Win64 OpenSSL 安装程序 - Shining Light Productions (slproweb.com)"),a(e)])]),n("p",null,[n("a",m,[s("(21) 一起学加密(23)——证书是什么 - YouTube"),a(e)])])]),d,v,n("ul",null,[n("li",null,[k,n("blockquote",null,[n("p",null,[n("a",h,[s("(21) 一起学加密(24)——openssl生成自签名证书(1) - YouTube"),a(e)])])]),b,n("blockquote",null,[n("p",null,[n("a",g,[s("google chrome - NET::ERR_CERT_VALIDITY_TOO_LONG - The server certificate has a validity period that is too long - Stack Overflow"),a(e)])])])]),n("li",null,[y,n("blockquote",null,[n("p",null,[n("a",_,[s("正确使用 OpenSSL 自签发代码|邮件|域名|IP 证书(附免费可信任 IP 证书申请) - VirCloud's Blog - Learning&Sharing"),a(e)])]),n("p",null,[n("a",E,[s("使用OpenSSL自签发SSL证书，支持chrome识别 - 程序人生♨︎ - 博客园 (cnblogs.com)"),a(e)])]),n("p",null,[n("a",f,[s("自签发SSL证书-解决本地开发跨域调试问题 - 掘金 (juejin.cn)"),a(e)])])]),A]),S])])}const P=p(i,[["render",x],["__file","index.html.vue"]]),T=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/","title":"加密算法","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"使用 openssl 生成自签名证书","slug":"使用-openssl-生成自签名证书","link":"#使用-openssl-生成自签名证书","children":[]}],"git":{"createdTime":1698080928000,"updatedTime":1709635981000,"contributors":[{"name":"233PC","email":"ayusummer233@gmail.com","commits":1},{"name":"Ayusummer","email":"ayusummer233@gmail.com","commits":1}]},"readingTime":{"minutes":2.16,"words":648},"filePathRelative":"网络安全/加密算法/index.md","localizedDate":"2023年10月23日","excerpt":"\\n<ul>\\n<li><a href=\\"#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95\\">加密算法</a>\\n<ul>\\n<li><a href=\\"#%E4%BD%BF%E7%94%A8-openssl-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6\\">使用 openssl 生成自签名证书</a></li>\\n</ul>\\n</li>\\n</ul>\\n<hr>\\n<h2>使用 openssl 生成自签名证书</h2>\\n<blockquote>\\n<p><a href=\\"https://slproweb.com/products/Win32OpenSSL.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Win32/Win64 OpenSSL Installer for Windows - Shining Light Productions --- 适用于 Windows 的 Win32/Win64 OpenSSL 安装程序 - Shining Light Productions (slproweb.com)</a></p>\\n<p><a href=\\"https://www.youtube.com/watch?v=1fln7glmX1E&amp;list=PLfQqWeOCIH4AZt3TiSRP4UuL_Y3gxYPAW&amp;index=23\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">(21) 一起学加密(23)——证书是什么 - YouTube</a></p>\\n</blockquote>"}');export{P as comp,T as data};
