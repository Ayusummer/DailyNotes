# Web 安全概述

> 内容源于 [山石网科 (hillstonenet.com.cn)](https://www.hillstonenet.com.cn/) 20220526 的技术分享
>
> TODO: 本版内容仅为初版, 后续需要补充

---

## 基本概念

### WEB 应用程序

WEB应用程序是指在HTTP协议基础之上，借助浏览器进行URL访问的网站。

![image-20220526150421908](http://cdn.ayusummer233.top/img/202205261504067.png)

---

### HTTP 协议

`HTTP协议（HyperText Transfer Protocol，超文本传输协议）`是用于**从WWW服务器传输超文本到本地浏览器的传送协议。**
HTTP是一个`应用层协议`，由请求和响应构成，是一个标准的客户端服务器模型。HTTP是一个无状态的协议。

![image-20220526150620505](http://cdn.ayusummer233.top/img/202205261506596.png)

---

### HTTP请求

HTTP请求由三部分组成，分别是:请求行、消息报头、请求正文

![image-20220526150654339](http://cdn.ayusummer233.top/img/202205261506484.png)

---

### HTTP 响应

http响应也由三部分组成，分别是︰状态行、消息报头、响应正文

![image-20220526150912767](http://cdn.ayusummer233.top/img/202205261509897.png)

---

### URL

**URL可以用来标识一个资源，而且还指明了如何locate这个资源URL一般由三部组成∶**

- 协议(或称为服务方式)
- 存有该资源的主机IP地址(有时也包括端口号)
- 主机资源的具体地址。如目录和文件名等

`schema://host[:port#]/path/.../[?query-string][#anchor]`

![image-20220526151104661](http://cdn.ayusummer233.top/img/202205261511717.png)

URL编码是一种浏览器用来打包表单输入的格式。浏览器从表单中获取所有的 name 和其中的值，将它们以 name/value 参数编码（移去那些不能传送的字符，将数据排行等等)作为URL的一部分或者分离地发给服务器

---

## Web 安全漏洞

### SQL 注入

SQL 注入是因为后台 SQL 语句拼接了用户的输入，而且 Web   应用程序对用户输入数据的合法性没有判断和过滤，前端传到后端的参数是攻击者可以控制的，并且将参数带入数据库中进行查询，攻击者可悻通过构造不同的 SQL 语句来实现对数据库的任意操作。例如可以增加、删除、修改数据库里的数据，如果权限过大，还可以执行服务器系统的命令。

![image-20220526151231215](http://cdn.ayusummer233.top/img/202205261512315.png)

![image-20220526151443160](http://cdn.ayusummer233.top/img/202205261514308.png)

---

### XSS

跨站点脚本（XSS）攻击是一种注射型攻击，攻击者在网页中嵌入恶意代码，用户访问网页时受到影响。

![image-20220526151754226](http://cdn.ayusummer233.top/img/202205261517314.png)

----

### CSRF漏洞

CSRF，是跨站请求伪造(Cross Site Request Forgery)的缩写，是一种劫持受信任用户向服务器发送非预期请求的攻击方式。

通常情况下，CSRF 攻击是攻击者借助受害者的Cookie骗取服务器的信任，在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器,从而在并未授权的情况下执行在权限保护之下的操作。

![image-20220526152041762](http://cdn.ayusummer233.top/img/202205261520861.png)

---

### SSRF 漏洞

`SSRF(Server-Side Request Forgery.服务器端请求伪造)` 是一种由攻击者构造数据进而伪造服务端请求的安全漏洞。一般情况下，SSRF 攻击的目标是从外网无法访问的内部系统。

![image-20220526152324376](http://cdn.ayusummer233.top/img/202205261523463.png)

---

### 反序列化漏洞

反序列化漏洞是指网站对用户可控制的数据进行反序列化时,攻击者能够操纵序列化的对象,将有害数据传递到应用程序代码中。

![image-20220526152522660](http://cdn.ayusummer233.top/img/202205261525752.png)

---

### XXE 漏洞

XXE Injection 即 XML External Entity Injection, 也就是 XML 外部实体注入攻击。XXE 漏洞发生在应用程序解析 XML 输入时，没有禁止外部实体的加载，导致可加载恶意外部文件和代码。

![image-20220526152806471](http://cdn.ayusummer233.top/img/202205261528545.png)

![image-20220526152814356](http://cdn.ayusummer233.top/img/202205261528456.png)

---

### 命令执行漏洞

当用户可以控制命令执行函数中的参数时，将可注入恶意系统命令到正常命令中造成命令执行攻击。

由于服务器端没有针对执行函数和对用户提交的内容进行过滤，所以产生了恶意命令。

![image-20220526152926118](http://cdn.ayusummer233.top/img/202205261529217.png)

`?ip=1|whoami`

---

### 文件上传漏洞

Web服务系统大部分都存在文件上传功能，比如允许用户上传文档、图片、头像、视频等。当用户点击上传时，服务端一般会对上传的文件进行判断，比如是否是指定的类型、后缀名等等，然后存储在指定的目录。当上传功能的实现代码没有严格校验上传文件的后缀和文件类型时候，攻击者可以上传恶意的代码文件并解析执行，从而控制整个服务器。

![image-20220526153108373](http://cdn.ayusummer233.top/img/202205261531469.png)

---

## 常用的工具

- 主机和端口存活扫描: `nmap`、`fscan`
- WEB 漏洞扫描: `AWVS`、`AppScan`、`Xray`
- 抓包工具: `BurpSuite`
- `Webshell` 管理工具: 中国蚁剑、冰蝎
- 网站目录文件扫描: `dirsearch`、御剑
- SQL 注入: `Sqlmap`

---

### Web 安全学习建议

学习建议: 多看文章、多实践、多交流、多做笔记、多总结

漏洞文章: 先知社区、安全客、freebuf、看雪、微信安全公众号

漏洞复现: [vulhub](https://vulhub.org)

CTF 训练平台: `BUUCTF`、`CTFHUB`、`Bugku`

交流学习: 团队(校内外的 CTF 等团队)、安全相关的 QQ 群和微信群

学习记录: 写博客（`hexo+github`、`wordpresss`)、语雀、有道云笔记、印象笔记等

---
